<!-- wave details start -->
<!-- {{ waveData | json }} -->

<div id="wave-content-id" class="wave__content__main__wrapper">
  <div
    id="wave-main-content"
    *ngIf="waveData"
    [ngClass]="{ 'side-open': edit }"
    class="wave__content__wrapper"
  >
    <!-- wave name and desription start -->
    <div class="wave__header">
      <img
        *ngIf="waveData.icon"
        [src]="waveData.icon"
        class="avatar"
        alt="{{ waveData.name }}"
      />
      <div *ngIf="!waveData.icon" style="padding-right: 25px;">
        <ngx-avatar
          class="my-avatar"
          name="{{ waveData.name }}"
          size="72"
        ></ngx-avatar>
      </div>
      <div class="wave__heading">
        <!-- {{ waveData.name }} -->
        <input
          class="description-styles"
          (click)="$event.target.select()"
          (focus)="onFocusTitle()"
          (keydown.enter)="
            $event.preventDefault() && updateTitle(); $event.target.blur()
          "
          (blur)="updateTitle()"
          [(ngModel)]="newTitle ? newTitle : waveData.name"
        />
      </div>

      <div class="wave-description">
        <!-- <div (mouseenter)="waveData.edit = true" *ngIf="!waveData.edit">
          {{ waveData.data.description }}
        </div> -->
        <!-- <textarea class="description-input" [(ngModel)]="waveData.description" (mouseleave)="waveData.edit = false"
                *ngIf="waveData.edit" rows="4"></textarea> -->
        <!-- <input
          class="description-input"
          [(ngModel)]="waveData.data.description"
          (mouseleave)="waveData.edit = false"
          *ngIf="waveData.edit"
        /> -->

        <input
          class="description-styles"
          style="color: var(--grayed-text);"
          (click)="$event.target.select()"
          (focus)="onFocusDescription()"
          (keydown.enter)="
            $event.preventDefault() && updateDescription(); $event.target.blur()
          "
          (blur)="updateDescription()"
          [(ngModel)]="
            newDescription ? newDescription : waveData.data.description
          "
        />
      </div>

      <img
        src="assets/imgs/vEllipsis.svg"
        alt="Template Settings"
        style="padding-left: 7.75em;"
      />
    </div>
    <!-- wave name and desription end -->

    <!-- template subheader -->
    <mat-tab-group [@.disabled]="true">
      <mat-tab label="Account">
        <!-- Account tab content -->
        <div *ngIf="accounts" style="height: 6em;">
          <mat-button-toggle-group disableRipple>
            <mat-button-toggle
              *ngFor="let account of accounts"
              value="{{ account.id }}"
            >
              {{ account.name }}
            </mat-button-toggle>
          </mat-button-toggle-group>

          <button mat-button class="add-account-btn">+ Add ENV</button>
        </div>

        <div class="template-container">
          <div class="templates__wrapper">
            <!-- wave templates list start-->
            <app-wave-list
              #templateList
              (rowClicked)="openDetails($event)"
              [waveData]="waveData"
            >
            </app-wave-list>
            <!-- wave templates list end-->
          </div>
        </div>
        <!-- End of Account tab content -->
      </mat-tab>
      <mat-tab label="Workflow">
        <!-- put workflow tab content here -->
        <!-- workflow tab subheader -->
        <div class="workflow-subheader">
          <mat-button-toggle-group
            style="min-width: 9.125em; max-width: 9.125em;"
            name="playbackControls"
          >
            <mat-button-toggle value="play">
              <img src="assets/imgs/play.svg" alt="play" />
            </mat-button-toggle>
            <mat-button-toggle value="pause">
              <img src="assets/imgs/pause.svg" alt="pause" />
            </mat-button-toggle>
            <mat-button-toggle value="stop">
              <img src="assets/imgs/stop.svg" alt="stop" />
            </mat-button-toggle>
          </mat-button-toggle-group>

          <mat-form-field class="item-select">
            <mat-select [(ngModel)]="items[0].value">
              <mat-option *ngFor="let item of items" [value]="item.value">
                {{ item.viewValue }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <div class="waves__list__filter">
            <div>
              <img class="search-icon" src="assets/imgs/search.svg" alt="" />
            </div>
            <div class="waves_list__search">
              <input
                (keyup)="search($event)"
                name="test"
                [(ngModel)]="searchKey"
                placeholder="Search"
                class="filter__input"
                type="text"
              />
            </div>
          </div>

          <mat-checkbox style="margin-left: 32px;">Templates</mat-checkbox>
          <mat-checkbox style="margin-left: 12px;">Workflows</mat-checkbox>
        </div>
        <!-- end of workflow tab subheader -->

        <!-- gruops list start -->
        <!-- main cdkdroplist which re orders groups -->
        <div class="drag-drop-parent">
          <div
            cdkDropList
            [cdkDropListData]="waveData.data.waveTypes"
            (cdkDropListDropped)="dropGroup($event)"
          >
            <div
              class="templates__inner__wrapper"
              *ngFor="
                let waveType of waveData.data.waveTypes
                  | search: waveData.searchKey;
                let i = index
              "
              cdkDropListGroup
              cdkDrag
              [cdkDragData]="waveType"
            >
              <!-- template list strats -->
              <div class="template-list-wrapper">
                <div>
                  <div class="template__row">
                    <div
                      class="template-name"
                      [ngStyle]="{ color: waveType.theme }"
                    >
                      <div
                        class="group-drag"
                        [ngClass]="{ 'do-not-show': !waveType.drag }"
                      >
                        <img src="assets/imgs/dragIcon-2.svg" alt="" />
                      </div>

                      <!-- group level actions starts -->
                      <!-- <div
                        [ngClass]="{ collapsed: waveType.collapsed }"
                        (click)="openGroupLevelActions(waveType)"
                        [ngStyle]="{ background: waveType.theme }"
                        class="accordian"
                      > -->
                      <div
                        [ngClass]="{ collapsed: waveType.collapsed }"
                        (click)="openGroupLevelActions(waveType)"
                        class="accordian"
                      >
                        <img
                          style="width: 24px; height: 24px;"
                          src="assets/imgs/chevron-down.svg"
                          alt=""
                        />
                        <div class="group-level-actions">
                          <div
                            (click)="waveType.collapsed = true"
                            *ngIf="!waveType.collapsed"
                          >
                            Collapse
                          </div>
                          <div
                            (click)="waveType.collapsed = false"
                            *ngIf="waveType.collapsed"
                          >
                            Expand
                          </div>
                          <div (click)="deleteGroup(waveType)">Delete</div>
                        </div>
                      </div>
                      <!-- group level actions ends -->

                      <div
                        class="group-name-wrapper"
                        (mouseenter)="groupNameEnter(waveType)"
                        (mouseleave)="waveType.edit = false"
                      >
                        <!-- <div class="group-name" *ngIf="!waveType.edit"> -->
                        <div class="group-name">
                          {{ waveType.name }}
                        </div>
                        <div style="margin-right: 10px;">
                          <span class="trigger-type">Trigger Type: </span
                          ><span class="trigger-type-val"
                            >&nbsp;{{ waveType.triggerType }}</span
                          >
                        </div>

                        <!-- <input
                          [ngStyle]="{
                            'border-color': waveType.theme,
                            color: waveType.theme
                          }"
                          [(ngModel)]="waveType.name"
                          class="group-input"
                          (focus)="waveType.drag = false"
                          (focusout)="waveType.drag = true"
                          *ngIf="waveType.edit"
                          type="text"
                          (mouseleave)="waveType.edit = false"
                        /> -->
                      </div>
                    </div>
                    <div *ngIf="!waveType.collapsed" class="template-status">
                      <span class="col-header">Status</span>
                    </div>
                    <div *ngIf="!waveType.collapsed" class="template-start">
                      <!-- <span class="bell-icon"><img src="assets/imgs/bell.svg" alt="" /></span> -->
                      <span class="col-header">Start Date</span>
                    </div>
                    <div *ngIf="!waveType.collapsed" class="template-end">
                      <!-- <span class="bell-icon"><img src="assets/imgs/bell.svg" alt="" /></span> -->
                      <span class="col-header">End Date</span>
                    </div>
                  </div>
                  <!-- cdkdroplist for template re ordering among and across groups -->
                  <div
                    *ngIf="!waveType.collapsed"
                    cdkDropList
                    id="{{ waveType.id }}"
                    [cdkDropListData]="waveData.data.waveTypes[i].templates"
                    (cdkDropListDropped)="drop($event)"
                    [cdkDropListConnectedTo]="getConnectedList()"
                  >
                    <div
                      class="template__row item"
                      [ngClass]="{ selected: template.selected }"
                      (click)="rowClick(template)"
                      *ngFor="let template of waveType.templates"
                      cdkDrag
                    >
                      <div class="template-name">
                        <!-- template level actions starts -->
                        <div class="row-starter">
                          <div
                            (click)="$event.stopPropagation()"
                            class="accordian"
                          >
                            <img src="assets/imgs/chevron-down.svg" alt="" />
                            <div class="group-level-actions">
                              <div (click)="deleteTemplate(waveType, template)">
                                Delete
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- template level actions starts -->

                        <div
                          [ngStyle]="{ background: waveType.theme }"
                          class="grid-start-line border-white"
                        ></div>
                        <div
                          class="border-white template-name-main"
                          (click)="toggleRightSidebar(template)"
                        >
                          <span class="cell-text">{{ template.name }}</span>
                        </div>
                      </div>
                      <div
                        class="border-white template-status"
                        [ngClass]="getStatusClass(template)"
                        (mouseleave)="template.showStatus = false"
                        (click)="showStatuses($event, template)"
                      >
                        <span
                          class="cell-text"
                          style="color: #fff; text-transform: uppercase;"
                          >{{ template.status }}</span
                        >
                        <!-- template status start -->
                        <div class="status-dropdown">
                          <div
                            (click)="changeStatus(template, 'Working on it')"
                            class="status__list__item status-yellow"
                          >
                            Working on it
                          </div>
                          <div
                            (click)="changeStatus(template, 'Done')"
                            class="status__list__item status-green"
                          >
                            Done
                          </div>
                          <div
                            (click)="changeStatus(template, 'Stuck')"
                            class="status__list__item status-red"
                          >
                            Stuck
                          </div>
                          <div
                            (click)="changeStatus(template, '')"
                            class="status__list__item"
                          ></div>
                        </div>
                        <!-- template status end -->
                      </div>
                      <div class="border-white template-start">
                        <span class="cell-text">{{ template.startDate }}</span>
                      </div>
                      <div class="border-white template-end">
                        <span class="cell-text">{{ template.endDate }}</span>
                      </div>
                    </div>
                    <div class="template__row item editor-row">
                      <!-- add new template strat -->
                      <div class="template-name">
                        <div class="row-starter"></div>
                        <div
                          [ngStyle]="{ background: waveType.theme }"
                          class="grid-start-line border-white"
                        ></div>
                        <div class="border-white template-name-main">
                          <input
                            (focus)="waveType.showAdd = true"
                            (focusout)="inputFocusOut($event, waveType)"
                            class="template-add"
                            (keydown.enter)="addTemplate(waveType)"
                            [(ngModel)]="waveType.newTemplate"
                            type="text"
                            placeholder="+Add"
                          />
                        </div>
                        <div
                          *ngIf="waveType.showAdd"
                          (click)="addTemplate(waveType)"
                          class="template-add-button"
                        >
                          Add
                        </div>
                      </div>
                      <!-- add new template end -->
                    </div>
                  </div>
                </div>
              </div>

              <!-- template list ends -->
            </div>
          </div>
        </div>
        <!-- gruops list end -->
      </mat-tab>
      <mat-tab label="Charts">
        <!-- put chart tab content here -->
      </mat-tab>
    </mat-tab-group>

    <!-- end of template subheader -->

    <!-- wave groups end -->
  </div>
  <!-- template details resizable start -->
  <section
    tabindex="-1"
    id="template-holder"
    (mouseenter)="showBackdrop = true"
    (mouseleave)="showBackdrop = false"
    *ngIf="waveData && edit"
    class="side-bar resizable"
    mwlResizable
    [enableGhostResize]="true"
    [resizeEdges]="{ bottom: false, right: false, top: false, left: true }"
    (resizeEnd)="onResizeEnd($event)"
  >
    <div (click)="openDetails(false)" class="close-template">x</div>
    <div>
      Template
    </div>
  </section>
  <div [ngClass]="{ show: showBackdrop }" class="modal-backdrop"></div>
  <!-- template details resizable start -->
</div>

<!-- wave details start -->

<!-- import sidebar -->
<div class="right-sidebar-container" *ngIf="rightSidebarToggleState">
  <div class="close-sidebar" (click)="rightSidebarToggleState = false">
    <img src="assets/imgs/close-sidebar.svg" alt="close-sidebar" />
  </div>
  <div style="margin: 0 24px 0 24px;">
    <app-template [templateData]="selectedTemplateInSidebar"></app-template>
  </div>
</div>
<!-- end of import sidebar -->
